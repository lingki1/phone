# 世界书预设导入和批量删除功能

## 功能概述

世界书系统现在支持：
1. **预设导入功能**：导入预设文件（如Marinara预设），自动转换为世界书格式
2. **批量删除功能**：支持选择多个世界书进行批量删除

## 预设导入功能

### 支持的格式

**Marinara预设格式**
- 包含 `prompts` 数组
- 每个prompt包含 `name`、`role`、`content` 等字段
- 自动过滤无用的条目（marker、空内容、说明文件等）

### 使用方法

1. **打开导入模态框**
   - 在世界书列表页面点击"导入"按钮

2. **导入预设文件**
   - 点击"📁 选择预设文件"上传预设文件
   - 或者直接粘贴预设JSON内容

3. **预览转换结果**
   - 点击"👁️ 预览转换"查看转换结果
   - 确认无误后点击"开始导入"

### 转换规则

#### 字段映射
- `name` → `name`（世界书名称）
- `content` → `content`（世界书内容）
- `role` → `category`（分类映射）

#### 分类映射
- `"system"` → `"系统规则"`
- `"user"` → `"用户角色"`
- `"assistant"` → `"助手角色"`
- 其他 → `"其他"`

#### 过滤规则
自动过滤以下条目：
- `marker: true` 的条目
- 空的 `content` 或 `name`
- 包含"Read-Me"、"说明"、"免责声明"等关键词的条目

## 批量删除功能

### 使用方法

1. **进入选择模式**
   - 在世界书列表页面点击"批量操作"按钮

2. **选择世界书**
   - 点击世界书左侧的复选框进行选择
   - 使用"全选"按钮选择所有世界书
   - 使用"取消全选"按钮取消所有选择

3. **执行批量删除**
   - 点击"删除 (数量)"按钮
   - 确认删除操作
   - 系统会显示删除结果

### 功能特点

- **选择模式**：进入选择模式后，世界书卡片会显示选择框
- **全选功能**：支持一键全选/取消全选当前筛选结果
- **实时计数**：显示已选择的世界书数量
- **安全确认**：删除前会要求用户确认
- **批量处理**：支持同时删除多个世界书
- **错误处理**：显示成功和失败的删除数量

## 示例

### Marinara预设格式
```json
{
  "prompts": [
    {
      "name": "┗ Rules",
      "role": "system",
      "content": "Important rules you must always follow...",
      "marker": false
    },
    {
      "name": "➊ Roleplay",
      "role": "system",
      "content": "You are an excellent game master...",
      "marker": false
    }
  ]
}
```

### 转换后的世界书
```json
[
  {
    "id": "preset_1234567890_abc123",
    "name": "┗ Rules",
    "content": "Important rules you must always follow...",
    "category": "系统规则",
    "createdAt": 1234567890,
    "updatedAt": 1234567890,
    "description": "从预设导入: ┗ Rules"
  },
  {
    "id": "preset_1234567890_def456",
    "name": "➊ Roleplay",
    "content": "You are an excellent game master...",
    "category": "系统规则",
    "createdAt": 1234567890,
    "updatedAt": 1234567890,
    "description": "从预设导入: ➊ Roleplay"
  }
]
```

## 功能特点

### 预设导入
1. **智能格式检测**：自动识别Marinara预设格式
2. **预览功能**：转换前可以预览结果
3. **过滤优化**：自动过滤无用内容
4. **分类映射**：智能分类转换
5. **错误处理**：完善的错误提示
6. **响应式设计**：支持移动端使用

### 批量删除
1. **选择模式**：清晰的选择界面
2. **全选功能**：便捷的全选/取消全选
3. **实时反馈**：显示选择数量
4. **安全确认**：删除前确认机制
5. **批量处理**：高效的批量操作
6. **结果反馈**：详细的删除结果

## 注意事项

1. **预设导入**
   - 确保预设文件格式正确
   - 预览转换结果后再导入
   - 导入后会生成新的ID和时间戳
   - 原有功能不受影响，完全向后兼容

2. **批量删除**
   - 删除操作不可撤销，请谨慎操作
   - 建议先备份重要数据
   - 删除过程中请勿关闭页面
   - 支持搜索结果的批量删除

## 技术实现

- 使用TypeScript确保类型安全
- 模块化设计，易于扩展
- 响应式CSS，适配各种屏幕
- 完善的错误处理机制
- 状态管理优化，提升用户体验

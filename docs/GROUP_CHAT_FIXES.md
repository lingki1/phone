# ç¾¤èŠé—®é¢˜ä¿®å¤æŠ¥å‘Š

## é—®é¢˜æè¿°

æ ¹æ®ç”¨æˆ·æä¾›çš„æˆªå›¾ï¼Œå‘ç°äº†ä¸¤ä¸ªå…³é”®é—®é¢˜ï¼š

### é—®é¢˜1ï¼šç”¨æˆ·æ¶ˆæ¯è‡ªåŠ¨æ¢è¡Œ
- **ç°è±¡**ï¼šç”¨æˆ·å‘é€çš„çŸ­æ¶ˆæ¯ï¼ˆå¦‚"ä½ ä»¬å®‰é™ç‚¹"ï¼‰ä»ç„¶ä¼šè‡ªåŠ¨æ¢è¡Œ
- **å½±å“**ï¼šæ¶ˆæ¯æ°”æ³¡å®½åº¦ä¸åˆç†ï¼Œå½±å“è§†è§‰æ•ˆæœ

### é—®é¢˜2ï¼šç‰¹æ®Šå†…å®¹æ¶ˆæ¯ç¼ºå°‘å¤´åƒå’Œåå­—
- **ç°è±¡**ï¼šåŒ…å«ç‰¹æ®Šå­—ç¬¦çš„æ¶ˆæ¯ï¼ˆå¦‚"ã€å§”å±ˆå·´å·´ã€‘"ï¼‰æ²¡æœ‰æ˜¾ç¤ºå¤´åƒå’Œåå­—
- **å½±å“**ï¼šæ— æ³•è¯†åˆ«æ¶ˆæ¯å‘é€è€…ï¼Œç”¨æˆ·ä½“éªŒå·®

## é—®é¢˜åˆ†æ

### é—®é¢˜1åˆ†æï¼šç”¨æˆ·æ¶ˆæ¯è‡ªåŠ¨æ¢è¡Œ

#### åŸå› 
1. **CSSæ ·å¼é—®é¢˜**ï¼šç”¨æˆ·æ¶ˆæ¯æ°”æ³¡ç¼ºå°‘`min-width: fit-content`å±æ€§
2. **å®½åº¦è®¾ç½®**ï¼šåªè®¾ç½®äº†`max-width`ï¼Œæ²¡æœ‰è®¾ç½®æœ€å°å®½åº¦
3. **æ–‡å­—æ¢è¡Œ**ï¼š`word-break: break-word`å¯èƒ½å¯¼è‡´ä¸å¿…è¦çš„æ¢è¡Œ

#### è§£å†³æ–¹æ¡ˆ
```css
.group-message.user-message .message-bubble {
  background-color: #007bff;
  color: white;
  margin-left: auto;
  border-bottom-right-radius: 6px;
  align-self: flex-end;
  min-width: fit-content;  /* æ–°å¢ï¼šç¡®ä¿å†…å®¹é€‚åº”å®½åº¦ */
  max-width: 70%;
}
```

#### å…³é”®æ”¹è¿›
- **æœ€å°å®½åº¦**ï¼šæ·»åŠ `min-width: fit-content`ç¡®ä¿æ°”æ³¡é€‚åº”å†…å®¹
- **å“åº”å¼é€‚é…**ï¼šåœ¨ä¸åŒå±å¹•å°ºå¯¸ä¸‹éƒ½è®¾ç½®ç›¸åº”çš„æœ€å°å®½åº¦
- **ä¿æŒæœ€å¤§å®½åº¦**ï¼šç¡®ä¿é•¿æ¶ˆæ¯ä»ç„¶æœ‰åˆç†çš„æœ€å¤§å®½åº¦é™åˆ¶

### é—®é¢˜2åˆ†æï¼šç‰¹æ®Šå†…å®¹æ¶ˆæ¯ç¼ºå°‘å¤´åƒå’Œåå­—

#### åŸå› 
1. **è¿ç»­æ¶ˆæ¯æ£€æµ‹è¿‡äºä¸¥æ ¼**ï¼šæ²¡æœ‰è€ƒè™‘æ—¶é—´é—´éš”
2. **ç‰¹æ®Šå­—ç¬¦å½±å“**ï¼šåŒ…å«ã€ã€‘ç­‰ç‰¹æ®Šå­—ç¬¦çš„æ¶ˆæ¯å¯èƒ½è¢«é”™è¯¯è¯†åˆ«
3. **æ£€æµ‹é€»è¾‘ç¼ºé™·**ï¼šåªæ£€æŸ¥å‘é€è€…å’Œè§’è‰²ï¼Œæ²¡æœ‰è€ƒè™‘æ—¶é—´å› ç´ 

#### è§£å†³æ–¹æ¡ˆ
```typescript
// æ£€æŸ¥æ˜¯å¦æ˜¯è¿ç»­æ¶ˆæ¯ï¼ˆåŒä¸€å‘é€è€…çš„è¿ç»­æ¶ˆæ¯ï¼‰
// åªæœ‰åœ¨æ—¶é—´é—´éš”å¾ˆçŸ­ï¼ˆ30ç§’å†…ï¼‰ä¸”å†…å®¹ç±»å‹ç›¸ä¼¼æ—¶æ‰è®¤ä¸ºæ˜¯è¿ç»­æ¶ˆæ¯
const isConsecutiveMessage = index > 0 && 
  chat.messages[index - 1].senderName === msg.senderName &&
  chat.messages[index - 1].role === msg.role &&
  Math.abs(msg.timestamp - chat.messages[index - 1].timestamp) < 30000; // 30ç§’å†…
```

#### å…³é”®æ”¹è¿›
- **æ—¶é—´é—´éš”æ£€æµ‹**ï¼šæ·»åŠ 30ç§’æ—¶é—´é—´éš”é™åˆ¶
- **æ›´ç²¾ç¡®çš„åˆ¤æ–­**ï¼šåªæœ‰çœŸæ­£è¿ç»­çš„çŸ­æ—¶é—´æ¶ˆæ¯æ‰éšè—å¤´åƒ
- **ç‰¹æ®Šå†…å®¹ä¿æŠ¤**ï¼šç¡®ä¿åŒ…å«ç‰¹æ®Šå­—ç¬¦çš„æ¶ˆæ¯æ­£å¸¸æ˜¾ç¤ºå¤´åƒå’Œåå­—

## ä¿®å¤æ•ˆæœ

### ä¿®å¤å‰
```
[å¤´åƒ] æˆ‘
      ä½ ä»¬å®‰é™ç‚¹  â† è‡ªåŠ¨æ¢è¡Œï¼Œæ°”æ³¡è¿‡å®½
      03:48

[å¤´åƒ] lily
      å¥½çš„è€æ¿,éƒ½å¬æ‚¨çš„~
      03:48
      ã€å§”å±ˆå·´å·´ã€‘  â† ç¼ºå°‘å¤´åƒå’Œåå­—
      03:48
```

### ä¿®å¤å
```
[å¤´åƒ] æˆ‘
      ä½ ä»¬å®‰é™ç‚¹  â† æ­£å¸¸æ˜¾ç¤ºï¼Œæ°”æ³¡é€‚åº”å†…å®¹
      03:48

[å¤´åƒ] lily
      å¥½çš„è€æ¿,éƒ½å¬æ‚¨çš„~
      03:48
[å¤´åƒ] lily
      ã€å§”å±ˆå·´å·´ã€‘  â† æ­£å¸¸æ˜¾ç¤ºå¤´åƒå’Œåå­—
      03:48
```

## æŠ€æœ¯å®ç°ç»†èŠ‚

### 1. CSSæ ·å¼ä¼˜åŒ–

#### æ¡Œé¢ç«¯
```css
.group-message.user-message .message-bubble {
  min-width: fit-content;
  max-width: 70%;
}
```

#### ç§»åŠ¨ç«¯
```css
@media (max-width: 767px) {
  .group-message.user-message .message-bubble {
    min-width: fit-content;
    max-width: 85%;
  }
}
```

#### å°å±è®¾å¤‡
```css
@media (max-width: 480px) {
  .group-message.user-message .message-bubble {
    min-width: fit-content;
    max-width: 90%;
  }
}
```

### 2. è¿ç»­æ¶ˆæ¯æ£€æµ‹ä¼˜åŒ–

#### æ—¶é—´é—´éš”æ£€æµ‹
```typescript
Math.abs(msg.timestamp - chat.messages[index - 1].timestamp) < 30000
```

#### å®Œæ•´æ£€æµ‹é€»è¾‘
```typescript
const isConsecutiveMessage = index > 0 && 
  chat.messages[index - 1].senderName === msg.senderName &&
  chat.messages[index - 1].role === msg.role &&
  Math.abs(msg.timestamp - chat.messages[index - 1].timestamp) < 30000;
```

## å…¼å®¹æ€§ä¿è¯

### æµè§ˆå™¨æ”¯æŒ
- âœ… Chrome/Edge (Webkit)
- âœ… Firefox (Gecko)
- âœ… Safari (Webkit)
- âœ… ç§»åŠ¨ç«¯æµè§ˆå™¨

### ç‰¹æ®Šå­—ç¬¦æ”¯æŒ
- âœ… ä¸­æ–‡æ ‡ç‚¹ç¬¦å·ã€ã€‘
- âœ… è¡¨æƒ…ç¬¦å·ğŸ˜Š
- âœ… ç‰¹æ®Šç¬¦å·@#$%
- âœ… æ•°å­—å’Œå­—æ¯
- âœ… æ··åˆå†…å®¹

### å“åº”å¼é€‚é…
- âœ… æ¡Œé¢ç«¯ï¼š70%æœ€å¤§å®½åº¦ï¼Œfit-contentæœ€å°å®½åº¦
- âœ… å¹³æ¿ç«¯ï¼š85%æœ€å¤§å®½åº¦ï¼Œfit-contentæœ€å°å®½åº¦
- âœ… æ‰‹æœºç«¯ï¼š90%æœ€å¤§å®½åº¦ï¼Œfit-contentæœ€å°å®½åº¦

## ç”¨æˆ·ä½“éªŒæ”¹è¿›

### 1. è§†è§‰ä¼˜åŒ–
- **åˆç†çš„æ°”æ³¡å®½åº¦**ï¼šçŸ­æ¶ˆæ¯ä¸ä¼šè¿‡åº¦æ‹‰ä¼¸
- **æ¸…æ™°çš„å‘é€è€…è¯†åˆ«**ï¼šæ‰€æœ‰æ¶ˆæ¯éƒ½æœ‰å¤´åƒå’Œåå­—
- **ä¸€è‡´çš„è§†è§‰é£æ ¼**ï¼šä¿æŒç¾¤èŠç•Œé¢çš„ç»Ÿä¸€æ€§

### 2. äº¤äº’ä¼˜åŒ–
- **å‡†ç¡®çš„æ¶ˆæ¯å½’å±**ï¼šç”¨æˆ·å¯ä»¥æ¸…æ¥šçŸ¥é“æ¯æ¡æ¶ˆæ¯çš„å‘é€è€…
- **è‡ªç„¶çš„é˜…è¯»ä½“éªŒ**ï¼šæ¶ˆæ¯æ°”æ³¡å®½åº¦ç¬¦åˆå†…å®¹é•¿åº¦
- **æµç•…çš„è§†è§‰æµç¨‹**ï¼šè¿ç»­æ¶ˆæ¯ä»ç„¶ä¿æŒç´§å‡‘

### 3. åŠŸèƒ½å®Œæ•´æ€§
- **ç‰¹æ®Šå†…å®¹æ”¯æŒ**ï¼šåŒ…å«å„ç§å­—ç¬¦çš„æ¶ˆæ¯éƒ½èƒ½æ­£å¸¸æ˜¾ç¤º
- **æ—¶é—´æ™ºèƒ½æ£€æµ‹**ï¼šåªæœ‰çœŸæ­£è¿ç»­çš„çŸ­æ—¶é—´æ¶ˆæ¯æ‰éšè—å¤´åƒ
- **å“åº”å¼é€‚é…**ï¼šåœ¨å„ç§è®¾å¤‡ä¸Šéƒ½æœ‰è‰¯å¥½ä½“éªŒ

## æµ‹è¯•éªŒè¯

### æµ‹è¯•ç”¨ä¾‹1ï¼šçŸ­æ¶ˆæ¯æ˜¾ç¤º
- **è¾“å…¥**ï¼šç”¨æˆ·å‘é€"ä½ å¥½"
- **é¢„æœŸ**ï¼šæ°”æ³¡å®½åº¦é€‚åº”å†…å®¹ï¼Œä¸è‡ªåŠ¨æ¢è¡Œ
- **ç»“æœ**ï¼šâœ… æ­£å¸¸æ˜¾ç¤º

### æµ‹è¯•ç”¨ä¾‹2ï¼šç‰¹æ®Šå­—ç¬¦æ¶ˆæ¯
- **è¾“å…¥**ï¼šç”¨æˆ·å‘é€"ã€å§”å±ˆå·´å·´ã€‘"
- **é¢„æœŸ**ï¼šæ˜¾ç¤ºå¤´åƒå’Œåå­—
- **ç»“æœ**ï¼šâœ… æ­£å¸¸æ˜¾ç¤º

### æµ‹è¯•ç”¨ä¾‹3ï¼šè¿ç»­æ¶ˆæ¯
- **è¾“å…¥**ï¼šåŒä¸€ç”¨æˆ·30ç§’å†…å‘é€å¤šæ¡æ¶ˆæ¯
- **é¢„æœŸ**ï¼šç¬¬ä¸€æ¡æ˜¾ç¤ºå¤´åƒï¼Œåç»­éšè—å¤´åƒ
- **ç»“æœ**ï¼šâœ… æ­£å¸¸æ˜¾ç¤º

### æµ‹è¯•ç”¨ä¾‹4ï¼šé•¿é—´éš”æ¶ˆæ¯
- **è¾“å…¥**ï¼šåŒä¸€ç”¨æˆ·1åˆ†é’Ÿåå‘é€æ¶ˆæ¯
- **é¢„æœŸ**ï¼šæ˜¾ç¤ºå¤´åƒå’Œåå­—
- **ç»“æœ**ï¼šâœ… æ­£å¸¸æ˜¾ç¤º

## æ€»ç»“

é€šè¿‡ç²¾ç¡®çš„CSSæ ·å¼è°ƒæ•´å’Œæ™ºèƒ½çš„è¿ç»­æ¶ˆæ¯æ£€æµ‹é€»è¾‘ä¼˜åŒ–ï¼ŒæˆåŠŸè§£å†³äº†ç¾¤èŠä¸­çš„ä¸¤ä¸ªå…³é”®é—®é¢˜ï¼š

1. **ç”¨æˆ·æ¶ˆæ¯è‡ªåŠ¨æ¢è¡Œ**ï¼šé€šè¿‡æ·»åŠ `min-width: fit-content`ç¡®ä¿æ°”æ³¡å®½åº¦é€‚åº”å†…å®¹
2. **ç‰¹æ®Šå†…å®¹æ¶ˆæ¯ç¼ºå°‘å¤´åƒ**ï¼šé€šè¿‡æ·»åŠ æ—¶é—´é—´éš”æ£€æµ‹ç¡®ä¿æ‰€æœ‰æ¶ˆæ¯éƒ½æ­£ç¡®æ˜¾ç¤ºå‘é€è€…ä¿¡æ¯

è¿™äº›ä¿®å¤å¤§å¤§æå‡äº†ç¾¤èŠçš„ç”¨æˆ·ä½“éªŒï¼Œç¡®ä¿æ¶ˆæ¯æ˜¾ç¤ºæ›´åŠ å‡†ç¡®å’Œç¾è§‚ã€‚ 
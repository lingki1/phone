# AI 预设管理功能

## 概述

AI 预设管理功能允许用户创建和管理不同的 AI 模型参数配置，以便在不同场景下获得最佳的 AI 回复效果。

## 功能特性

### 🎯 预设模板
- **创意模式**: 高创造性，适合创意写作和头脑风暴
- **平衡模式**: 平衡的创造性和一致性，适合一般对话
- **精确模式**: 低创造性，高一致性，适合事实性回答
- **简洁模式**: 简短精炼的回答，适合快速获取信息
- **详细模式**: 详细全面的回答，适合深度分析

### ⚙️ 参数配置
支持所有 OpenAI API 参数：

#### 核心参数
- **温度 (Temperature)**: 0-2，控制输出的随机性
- **最大令牌数 (Max Tokens)**: 1-4000，限制回复的最大长度
- **Top P**: 0-1，控制词汇选择的多样性

#### 惩罚参数
- **频率惩罚 (Frequency Penalty)**: -2.0 到 2.0，减少重复词汇的使用
- **存在惩罚 (Presence Penalty)**: -2.0 到 2.0，减少新话题的引入

#### 高级参数
- **Top K**: 可选，限制词汇选择范围
- **响应格式**: 文本格式或 JSON 格式
- **随机种子**: 可选，确保结果的可重现性
- **停止序列**: 可选，指定停止生成的序列
- **对数偏差**: 可选，调整特定词汇的概率

## 使用方法

### 1. 访问预设管理
1. 点击底部导航栏的"我"按钮
2. 在个人页面中找到"AI 预设管理"选项
3. 点击进入预设管理页面

### 2. 创建新预设

#### 从模板创建
1. 点击"新建预设"按钮
2. 选择"从模板创建"标签页
3. 选择一个预设模板
4. 可选：自定义预设名称
5. 点击"从模板创建"按钮

#### 自定义创建
1. 点击"新建预设"按钮
2. 选择"自定义创建"标签页
3. 输入预设名称
4. 点击"创建预设"按钮
5. 创建后可以编辑详细参数

### 3. 编辑预设
1. 在预设卡片上点击编辑按钮（✏️）
2. 修改预设参数
3. 点击"保存预设"按钮

### 4. 设置当前预设
1. 在预设卡片上点击"设为当前"按钮
2. 该预设将应用于所有新的 AI 对话

### 5. 管理预设
- **复制预设**: 点击复制按钮（📋）
- **删除预设**: 点击删除按钮（🗑️），默认预设不可删除

## 预设参数说明

### 温度 (Temperature)
- **低值 (0.1-0.3)**: 输出更确定，适合事实性回答
- **中值 (0.4-0.7)**: 平衡的创造性和一致性
- **高值 (0.8-1.2)**: 输出更随机，适合创意写作

### 最大令牌数 (Max Tokens)
- **短回复 (100-500)**: 快速获取信息
- **中等回复 (500-1500)**: 一般对话
- **长回复 (1500-3000)**: 详细分析

### Top P
- **低值 (0.1-0.3)**: 选择最可能的词汇
- **中值 (0.4-0.7)**: 平衡的词汇选择
- **高值 (0.8-1.0)**: 考虑更多词汇选项

### 频率惩罚
- **正值**: 减少重复词汇
- **负值**: 允许更多重复
- **零值**: 不施加惩罚

### 存在惩罚
- **正值**: 减少新话题引入
- **负值**: 鼓励探索新话题
- **零值**: 不施加惩罚

## 技术实现

### 数据库结构
```typescript
interface PresetConfig {
  id: string;
  name: string;
  description: string;
  isDefault?: boolean;
  createdAt: number;
  updatedAt: number;
  temperature: number;
  maxTokens: number;
  topP: number;
  topK?: number;
  frequencyPenalty: number;
  presencePenalty: number;
  stopSequences?: string[];
  logitBias?: Record<string, number>;
  responseFormat?: 'text' | 'json_object';
  seed?: number;
  user?: string;
}
```

### 文件结构
```
src/app/components/qq/preset/
├── PresetManagerPage.tsx    # 预设管理主页面
├── PresetManagerPage.css    # 预设管理页面样式
├── PresetCard.tsx          # 预设卡片组件
├── PresetCard.css          # 预设卡片样式
├── PresetEditor.tsx        # 预设编辑器组件
├── PresetEditor.css        # 预设编辑器样式
├── CreatePresetModal.tsx   # 创建预设模态框
└── CreatePresetModal.css   # 创建预设模态框样式
```

### 核心文件
- `src/app/types/preset.ts`: 预设类型定义
- `src/app/utils/presetManager.ts`: 预设管理器
- `src/app/utils/dataManager.ts`: 数据库操作（已扩展）

## 主题集成

预设功能完全集成了主题系统：

### 支持的 CSS 变量
- `--theme-bg-primary`: 主背景色
- `--theme-bg-secondary`: 次要背景色
- `--theme-bg-tertiary`: 第三级背景色
- `--theme-text-primary`: 主文本色
- `--theme-text-secondary`: 次要文本色
- `--theme-accent-color`: 强调色
- `--theme-border-color`: 边框色
- `--theme-shadow-light`: 浅阴影
- `--theme-shadow-medium`: 中等阴影
- `--theme-shadow-heavy`: 重阴影

### 深色主题适配
所有组件都支持深色主题，自动适配颜色和对比度。

### 响应式设计
- 桌面端：网格布局，多列显示
- 平板端：单列布局，优化触摸操作
- 移动端：垂直布局，简化交互

### 无障碍支持
- 高对比度模式
- 减少动画偏好
- 键盘导航支持
- 屏幕阅读器友好

## 最佳实践

### 预设命名
- 使用描述性的名称
- 包含主要用途或场景
- 避免过于技术性的术语

### 参数调优
- 根据具体用途调整参数
- 测试不同参数组合的效果
- 记录成功的参数配置

### 预设分类
- 按用途分类（创意、分析、对话等）
- 按复杂度分类（简单、中等、高级）
- 按场景分类（工作、学习、娱乐等）

## 故障排除

### 常见问题

#### 预设不生效
1. 检查是否已设置为当前预设
2. 确认 API 配置正确
3. 验证参数值在有效范围内

#### 创建预设失败
1. 检查预设名称是否为空
2. 确认参数值在有效范围内
3. 查看浏览器控制台错误信息

#### 预设列表为空
1. 检查数据库连接
2. 尝试刷新页面
3. 查看是否已初始化默认预设

### 调试信息
在浏览器控制台中可以看到详细的调试信息：
- 预设加载状态
- 参数验证结果
- API 请求详情
- 错误信息

## 更新日志

### v1.0.0 (当前版本)
- ✅ 基础预设管理功能
- ✅ 预设模板系统
- ✅ 参数编辑器
- ✅ 主题系统集成
- ✅ 响应式设计
- ✅ 无障碍支持
- ✅ 数据库持久化

### 计划功能
- 🔄 预设导入/导出
- 🔄 预设分享功能
- 🔄 预设使用统计
- �� 智能参数推荐
- 🔄 预设版本管理 